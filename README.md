 Python Security
============
 Source Code Auto Audit
------------------
pyblade参考了王垠的在pysonar2项目中对python的语法树解析，具体来讲就是利用了他的python_dump.py文件会对python源代码文件进行解析，他的项目地址:https://github.com/yinwang0/pysonar2


### 基本原理：
-----
    污点分析有三大元素：污点源、敏感规则、敏感宿。
    污点源是指可能引起程序产生各类安全问题的数据来源(如键盘的输入，秘密数据或恶意数据)，污点源主要分两大类：
* Python的命令行参数sys.argv[]，sys.argv[0]表示代码本身文件路径，所以可控参数的索引从1开始。
* 不安全的外部数据输入函数。如网络数据接收函数：web.input从网络获取数据,socket.read读取socket包,requests.get读取服务器响应的内容。
还有如文件内容读取函数，路径读取函数等等。敏感规则就是争对安全漏洞的形成原理制定防范规则，敏感宿就是含有可控参数的执行危险函数的命令语句。
    
### 实现方法：
------------------
    先利用dump_python文件对Python源代码进行字典化保存，然后取相应的键和值，找到sys.argv所在的位置，标记污染源，然后分析敏感路径，最后找到敏感宿，形成污染分析的最终结果。
    实现函数的概要信息时，通过递归查找出所有函数定义的行号，利用行号和文件名产生一个UUID，然后找到所有的函数调用，并把其添加到'call'的字典里的键值里。

### 用法：
------------------
解压安装压缩包，进入源代码主目录，使用python setup.py install命令进行安装。
代码示例：
```python
from pyblade import scan

files = {
           'taintanalysis.py': 'os.system('cmd')\n\n' }

scan(files)
```
files是待检测的代码生成的字典。生成的具体方法参见tests目录下的readme


### 文件说明：
-----
* color_log.py 用于对log进行着色
* dump_python.py 对Python进行语法树分析,把源文件转成一个字典保存
* cfg_generate.py 用于产生控制流图

### License
-----
本源代码遵循GNU通用公共授权V2.0及以上版本

GNU 通用公共授权

第二版, 1991年6月

著作权所有 (C) 1989，1991 Free Software Foundation, Inc.
59 Temple Place, Suite 330, Boston, MA 02111-1307 USA


您可以修改本程序的一个或数个复制物或者本程序的任何部份，以此形成基于本程序所生的著作，并依前述第一条规定，复制与发布此一修改过的程序或著作，但您必须符合以下要件：

(a) 您必须在所修改的挡案上附加显著的标示，阐明您修改过这些挡案，以及修改日期。

(b) 您必须就您所发布或发行的著作，无论是包含本程序全部或一部的著作，或者是自本程序或其任何部份所衍生的著作，整体授权所有第三人依本授权规定使用，且不得因此项授权行为而收取任何费用。

(c) 若经过修改的程序在执行时通常以交互方式读取命令时，您必须在最常被使用的方式下，于开始进入这种交互式使用时，列印或展示以下宣告：适当的著作权标示及无担保声明（或者声明您提供担保）、使用者可以依这些条件再发布此程序，以及告知使用者如何浏览本授权的副本。

允许每个人复制和发布本授权文件的完整副本，
但不允许对它进行任何修改。
